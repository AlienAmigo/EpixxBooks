!function(e){var t={};function n(r){if(t[r])return t[r].exports;var c=t[r]={i:r,l:!1,exports:{}};return e[r].call(c.exports,c,c.exports,n),c.l=!0,c.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)n.d(r,c,function(t){return e[t]}.bind(null,c));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/js",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var r=()=>{let e=[];localStorage.getItem("my-cart")&&(e=JSON.parse(localStorage.getItem("my-cart")));document.querySelector(".page-header__cart-num");const t=e=>{document.querySelector(".page-header__cart-num").textContent=e.length};t(e);const n=n=>{(async()=>{await fetch(r).then(e=>e.json()).then(r=>{const c=r.filter(e=>e.uri==n),o=e.findIndex(e=>e.uri===n);-1===o?e.push({...c[0],qty:1}):e[o].qty+=1,(e=>{localStorage.setItem("my-cart",JSON.stringify(e)),console.log(e),t(e)})(e),t(e)}).catch(e=>{console.log(e)})})()},r="/data/data.json";let c=2,o=8,a=document.querySelector(".catalog__books-list"),l=document.querySelector(".tmp-book-card");function i(e){let t=l.content.cloneNode(!0);return e.hasOwnProperty("new")&&1==e.new||t.querySelector(".card__new").parentElement.removeChild(t.querySelector(".card__new")),t.querySelector(".card").dataset.id=`${e.uri}`,t.querySelector(".card__inner").href=`index.html#${e.uri}`,t.querySelector(".card__img").src=`/img/books/${e.uri}.jpg`,t.querySelector(".card__img").alt=e.name,t.querySelector(".card__title").textContent=e.name,t.querySelector(".card__price").textContent=convRUB(e.price),t}const d=document.querySelector("[data-catalog]");d&&d.addEventListener("click",e=>{const{target:t}=e,c=t.closest(".card"),o=c.dataset.id,a=c.querySelector(".card__buy"),l=c.querySelector(".card__buy span");console.log(t),c&&t!=a&&t!=l?function(e){(async()=>{await fetch(r).then(e=>e.json()).then(t=>{let r=t.find(t=>t.uri==e);m.querySelector(".product__img-wrap img").src=`/img/books/${r.uri}.jpg`,m.querySelector(".product__img-wrap img").alt=r.name,m.querySelector(".product__title").textContent=r.name,m.querySelector(".product__descr").querySelector("p").textContent=r.desc;const c=m.querySelector(".btn--price");c.innerHTML=convRUB(r.price)+'                      <span class="btn__sm-text">\n                        <svg class="btn__icon" width="14" height="14">\n                          <use xlink:href="#plus"></use>\n                        </svg>\n                        <span>В корзину</span>',c.addEventListener("click",(function(){n(e)})),m.classList.add("modal--open")}).catch(e=>{console.log(e)})})()}(o):c&&n(o)}),a&&function(){for(let e=0;e<o;e++)(async()=>{await fetch(r).then(e=>e.json()).then(t=>{let n=o*(c-1)+e;n<t.length-1&&a.appendChild(i(t[n]))}).catch(e=>{console.log(e)})})()}();let s=document.querySelector("#filters"),u=document.querySelector("#filters-trigger");s&&u&&u.addEventListener("click",(function(){s.classList.toggle("filters--open")}));let m=document.querySelector("#modal-book-view"),p=document.querySelector(".modal__dialog"),g=document.querySelector(".modal__close");function f(){m.classList.remove("modal--open")}p&&p.addEventListener("click",(function(e){e.stopPropagation()})),m&&g&&(m.addEventListener("click",f),g.addEventListener("click",f))};var c=()=>{};var o,a=()=>{document.querySelector("#popular-slider")&&new Glide("#popular-slider",{type:"carousel",focusAt:"center",perView:4}).mount()};o=function(){function e(e){return"ru"==e?'<span class="field-select__lang-ru"></span>':"en"==e?'<span class="field-select__lang-en"></span>':'<span class="field-select__lang-null"></span>'}c(),window.convRUB=function(e,t="₽"){let n=e.toString();if(n.match(/\d{4,}/g))for(;n.replace(/(\d+)(\d{3}(\s\d{3})*$)/g,"$1 $2")!=n;)n=n.replace(/(\d+)(\d{3}(\s\d{3})*$)/g,"$1 $2");return null!=t&&t.length&&!t.match([/^[\s]+$/g])&&(n=`${n} ${t.trim()}`),n},r(),a(),new Choices(".field-select:not(#lang) select.field-select__select",{searchEnabled:!1,shouldSort:!1}),new Choices("#lang select.field-select__select",{searchEnabled:!1,shouldSort:!1,callbackOnCreateTemplates:function(t){return{item:(n,r)=>t(`\n            <div class="${n.item} ${r.highlighted?n.highlightedState:n.itemSelectable}" data-item data-id="${r.id}" data-value="${r.value}" ${r.active?'aria-selected="true"':""} ${r.disabled?'aria-disabled="true"':""}>\n              ${e(r.value)} ${r.label.substr(0,3)}\n            </div>\n          `),choice:(n,r)=>t(`\n            <div class="${n.item} ${n.itemChoice} ${r.disabled?n.itemDisabled:n.itemSelectable}" data-select-text="${this.config.itemSelectText}" data-choice ${r.disabled?'data-choice-disabled aria-disabled="true"':"data-choice-selectable"} data-id="${r.id}" data-value="${r.value}" ${r.groupId>0?'role="treeitem"':'role="option"'}>\n              ${e(r.value)} ${r.label}\n            </div>\n          `)}}});var t=document.getElementById("price-range");noUiSlider.create(t,{start:[400,1e3],connect:!0,step:100,range:{min:200,max:2e3}})},(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?o():document.addEventListener("DOMContentLoaded",o)}]);